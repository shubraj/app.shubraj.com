{% extends "app/base.html" %}
{% load static %}

{% block title %}HSTS Checker - Verify HTTP Strict Transport Security | Shub Raj Apps{% endblock %}

{% block description %}Check if a domain has HSTS (HTTP Strict Transport Security) enabled. Verify max-age, includeSubDomains, and preload directives. Free online security checker.{% endblock %}

{% block keywords %}hsts checker, http strict transport security, hsts validator, security headers checker, hsts test{% endblock %}

{% block og_title %}HSTS Checker - Free Online Tool{% endblock %}

{% block og_description %}Check HSTS configuration for any domain. Verify Strict-Transport-Security header, max-age, and security settings.{% endblock %}

{% block breadcrumb_items %}
<li aria-current="page">HSTS Checker</li>
{% endblock %}

{% block content %}
<section class="hash-section">
    <h2>HSTS Checker</h2>
    <p>Check if a domain has HTTP Strict Transport Security (HSTS) enabled. HSTS forces browsers to use HTTPS connections.</p>

    {% if errors %}
    <div class="feedback-container">
        {% for err in errors %}
        <div class="feedback-message error">{{ err }}</div>
        {% endfor %}
    </div>
    {% endif %}

    <form method="post" class="card">
        {% csrf_token %}
        <label for="domainInput">Domain Name</label>
        <input id="domainInput" name="domain" type="text" class="text-input" 
               placeholder="example.com (without https://)" 
               value="{{ domain }}" required>
        <div class="action-buttons">
            <button class="btn" type="submit">Check HSTS</button>
            <button class="btn" type="button" id="clearHstsBtn">Clear</button>
        </div>
    </form>

    {% if hsts_info %}
    <div class="header-info" style="margin-top:1.5rem;">
        <h3>HSTS Check Results</h3>
        
        <div style="margin-bottom:1rem;">
            <h4 style="color:var(--accent-color); margin-bottom:0.5rem;">Domain</h4>
            <p><strong>{{ hsts_info.domain }}</strong></p>
        </div>

        {% if hsts_info.status == 'enabled' %}
        <div style="margin-bottom:1rem; padding:0.75rem; background:#064e3b; border-radius:0.5rem; border-left:4px solid #10b981;">
            <p style="margin:0; color:#10b981; font-weight:600;">
                ✓ HSTS Enabled
            </p>
        </div>
        
        <div style="margin-bottom:1rem;">
            <h4 style="color:var(--accent-color); margin-bottom:0.5rem;">Header Value</h4>
            <pre style="font-family:monospace; font-size:0.85rem; background:#1f2937; padding:0.75rem; border-radius:0.5rem; overflow-x:auto; margin:0;">{{ hsts_info.header_value }}</pre>
        </div>

        {% if hsts_info.max_age %}
        <div style="margin-bottom:1rem;">
            <h4 style="color:var(--accent-color); margin-bottom:0.5rem;">Max-Age</h4>
            <ul style="margin:0.5rem 0; padding-left:1.5rem;">
                <li><strong>{{ hsts_info.details.max_age_seconds }}</strong> seconds</li>
                <li><strong>{{ hsts_info.details.max_age_days }}</strong> days</li>
                {% if hsts_info.details.max_age_years > 0 %}
                <li><strong>{{ hsts_info.details.max_age_years }}</strong> year{{ hsts_info.details.max_age_years|pluralize }}</li>
                {% endif %}
                <li>Policy type: <strong>{{ hsts_info.details.policy_type }}</strong></li>
            </ul>
        </div>
        {% endif %}

        <div style="margin-bottom:1rem;">
            <h4 style="color:var(--accent-color); margin-bottom:0.5rem;">Directives</h4>
            <ul style="margin:0.5rem 0; padding-left:1.5rem;">
                <li>
                    <strong>includeSubDomains:</strong> 
                    {% if hsts_info.include_subdomains %}
                    <span style="color:#10b981;">✓ Enabled</span> (Applies to all subdomains)
                    {% else %}
                    <span style="color:#ef4444;">✗ Not set</span>
                    {% endif %}
                </li>
                <li>
                    <strong>preload:</strong> 
                    {% if hsts_info.preload %}
                    <span style="color:#10b981;">✓ Enabled</span> (Eligible for browser preload lists)
                    {% else %}
                    <span style="color:#ef4444;">✗ Not set</span>
                    {% endif %}
                </li>
            </ul>
        </div>

        {% if hsts_info.details.additional_headers %}
        <div style="margin-bottom:1rem;">
            <h4 style="color:var(--accent-color); margin-bottom:0.5rem;">Additional Security Headers</h4>
            <ul style="margin:0.5rem 0; padding-left:1.5rem;">
                {% if hsts_info.details.additional_headers.csp %}
                <li>✓ Content-Security-Policy</li>
                {% endif %}
                {% if hsts_info.details.additional_headers.x_frame_options %}
                <li>✓ X-Frame-Options</li>
                {% endif %}
                {% if hsts_info.details.additional_headers.x_content_type_options %}
                <li>✓ X-Content-Type-Options</li>
                {% endif %}
            </ul>
        </div>
        {% endif %}

        {% elif hsts_info.status == 'not_enabled' %}
        <div style="margin-bottom:1rem; padding:0.75rem; background:#78350f; border-radius:0.5rem; border-left:4px solid #f59e0b;">
            <p style="margin:0; color:#f59e0b; font-weight:600;">
                ⚠ HSTS Not Enabled
            </p>
            {% if hsts_info.details.recommendation %}
            <p style="margin:0.5rem 0 0 0; opacity:0.9; font-size:0.9rem;">
                {{ hsts_info.details.recommendation }}
            </p>
            {% endif %}
        </div>
        {% elif hsts_info.error %}
        <div style="margin-bottom:1rem; padding:0.75rem; background:#7f1d1d; border-radius:0.5rem; border-left:4px solid #ef4444;">
            <p style="margin:0; color:#ef4444; font-weight:600;">
                ✗ Error
            </p>
            <p style="margin:0.5rem 0 0 0; opacity:0.9;">{{ hsts_info.error }}</p>
        </div>
        {% endif %}

        {% if hsts_info.final_url %}
        <div style="margin-bottom:1rem;">
            <h4 style="color:var(--accent-color); margin-bottom:0.5rem;">Checked URL</h4>
            <p style="font-family:monospace; font-size:0.9rem; word-break:break-all;">{{ hsts_info.final_url }}</p>
        </div>
        {% endif %}
    </div>
    {% endif %}

    <div class="header-info" style="margin-top:1rem;">
        <h3>About HSTS</h3>
        <p>HTTP Strict Transport Security (HSTS) is a security policy that forces browsers to use HTTPS connections. When enabled, it helps prevent protocol downgrade attacks and cookie hijacking.</p>
        <ul style="margin-top:0.5rem;">
            <li><strong>max-age:</strong> How long (in seconds) browsers should remember to use HTTPS</li>
            <li><strong>includeSubDomains:</strong> Extends HSTS to all subdomains</li>
            <li><strong>preload:</strong> Indicates the site should be included in browser preload lists</li>
        </ul>
    </div>
</section>

{% include 'app/fragments/seo/hsts-checker-seo.html' %}
{% endblock %}

{% block scripts %}
<script>
    document.getElementById('clearHstsBtn')?.addEventListener('click', () => {
        document.getElementById('domainInput').value = '';
        document.getElementById('domainInput').focus();
    });
</script>
{% endblock %}

